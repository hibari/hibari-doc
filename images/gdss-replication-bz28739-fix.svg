<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="600pt" height="1237pt" version="1.1" viewBox="0 0 600 1237"
 viewBox="0 0 600 1237"
 xmlns="http://www.w3.org/2000/svg" shape-rendering="crispEdges"
 stroke-width="1" text-rendering="geometricPrecision">
<polygon fill="white" points="37,6 81,6 81,16 37,16"/>
<text x="60" y="15" textLength="42" font-family="Helvetica" font-size="12" fill="black" text-anchor="middle">

CLIENT
</text>
<polygon fill="white" points="162,6 196,6 196,16 162,16"/>
<text x="180" y="15" textLength="33" font-family="Helvetica" font-size="12" fill="black" text-anchor="middle">

HEAD
</text>
<polygon fill="white" points="276,6 322,6 322,16 276,16"/>
<text x="300" y="15" textLength="45" font-family="Helvetica" font-size="12" fill="black" text-anchor="middle">

MIDDLE
</text>
<polygon fill="white" points="406,6 432,6 432,16 406,16"/>
<text x="420" y="15" textLength="25" font-family="Helvetica" font-size="12" fill="black" text-anchor="middle">

TAIL
</text>
<polygon fill="white" points="519,6 559,6 559,16 519,16"/>
<text x="540" y="15" textLength="38" font-family="Helvetica" font-size="12" fill="black" text-anchor="middle">

ADMIN
</text>
<line x1="60" y1="22" x2="60" y2="49" stroke="black"/>
<line x1="180" y1="22" x2="180" y2="49" stroke="black"/>
<line x1="300" y1="22" x2="300" y2="49" stroke="black"/>
<line x1="420" y1="22" x2="420" y2="49" stroke="black"/>
<line x1="540" y1="22" x2="540" y2="49" stroke="black"/>
<polygon fill="white" points="268,29 331,29 331,39 268,39"/>
<text x="269" y="38" textLength="61" font-family="Helvetica" font-size="12" fill="black">
D1 = K1,V1
</text>
<line x1="30" y1="35" x2="268" y2="35" stroke="black" stroke-dasharray="2,2"/>
<line x1="333" y1="35" x2="570" y2="35" stroke="black" stroke-dasharray="2,2"/>
<line x1="60" y1="49" x2="60" y2="76" stroke="black"/>
<line x1="180" y1="49" x2="180" y2="76" stroke="black"/>
<line x1="300" y1="49" x2="300" y2="76" stroke="black"/>
<line x1="420" y1="49" x2="420" y2="76" stroke="black"/>
<line x1="540" y1="49" x2="540" y2="76" stroke="black"/>
<line x1="60" y1="62" x2="180" y2="62" stroke="black"/>
<line x1="180" y1="62" x2="170" y2="68" stroke="black"/>
<polygon fill="white" points="88,51 150,51 150,61 88,61"/>
<text x="89" y="60" textLength="60" font-family="Helvetica" font-size="12" fill="black">
add(K1,V1)
</text>
<line x1="60" y1="76" x2="60" y2="103" stroke="black"/>
<line x1="180" y1="76" x2="180" y2="103" stroke="black"/>
<line x1="300" y1="76" x2="300" y2="103" stroke="black"/>
<line x1="420" y1="76" x2="420" y2="103" stroke="black"/>
<line x1="540" y1="76" x2="540" y2="103" stroke="black"/>
<polygon fill="white" points="128,76 232,76 232,101 128,101"/>
<line x1="128" y1="76" x2="232" y2="76" stroke="black"/>
<line x1="128" y1="101" x2="232" y2="101" stroke="black"/>
<line x1="128" y1="76" x2="128" y2="101" stroke="black"/>
<line x1="232" y1="76" x2="232" y2="101" stroke="black"/>
<polygon fill="white" points="122,83 236,83 236,93 122,93"/>
<text x="123" y="92" textLength="112" font-family="Helvetica" font-size="12" fill="black">
replay=D1; down=S1
</text>
<line x1="60" y1="103" x2="60" y2="130" stroke="black"/>
<line x1="180" y1="103" x2="180" y2="130" stroke="black"/>
<line x1="300" y1="103" x2="300" y2="130" stroke="black"/>
<line x1="420" y1="103" x2="420" y2="130" stroke="black"/>
<line x1="540" y1="103" x2="540" y2="130" stroke="black"/>
<line x1="180" y1="116" x2="300" y2="116" stroke="black"/>
<line x1="300" y1="116" x2="290" y2="122" stroke="black"/>
<polygon fill="white" points="164,105 314,105 314,115 164,115"/>
<text x="165" y="114" textLength="148" font-family="Helvetica" font-size="12" fill="black">
ch_replay_v2(K1,V1,S1,S0)
</text>
<line x1="60" y1="130" x2="60" y2="157" stroke="black"/>
<line x1="180" y1="130" x2="180" y2="157" stroke="black"/>
<line x1="300" y1="130" x2="300" y2="157" stroke="black"/>
<line x1="420" y1="130" x2="420" y2="157" stroke="black"/>
<line x1="540" y1="130" x2="540" y2="157" stroke="black"/>
<polygon fill="white" points="248,130 352,130 352,155 248,155"/>
<line x1="248" y1="130" x2="352" y2="130" stroke="black"/>
<line x1="248" y1="155" x2="352" y2="155" stroke="black"/>
<line x1="248" y1="130" x2="248" y2="155" stroke="black"/>
<line x1="352" y1="130" x2="352" y2="155" stroke="black"/>
<polygon fill="white" points="250,137 348,137 348,147 250,147"/>
<text x="251" y="146" textLength="96" font-family="Helvetica" font-size="12" fill="black">
replay=D1; up=S1
</text>
<line x1="60" y1="157" x2="60" y2="184" stroke="black"/>
<line x1="180" y1="157" x2="180" y2="184" stroke="black"/>
<line x1="300" y1="157" x2="300" y2="184" stroke="black"/>
<line x1="420" y1="157" x2="420" y2="184" stroke="black"/>
<line x1="540" y1="157" x2="540" y2="184" stroke="black"/>
<line x1="300" y1="170" x2="420" y2="170" stroke="black"/>
<line x1="420" y1="170" x2="410" y2="176" stroke="black"/>
<polygon fill="white" points="284,159 434,159 434,169 284,169"/>
<text x="285" y="168" textLength="148" font-family="Helvetica" font-size="12" fill="black">
ch_replay_v2(K1,V1,S1,S0)
</text>
<line x1="60" y1="184" x2="60" y2="211" stroke="black"/>
<line x1="180" y1="184" x2="180" y2="211" stroke="black"/>
<line x1="300" y1="184" x2="300" y2="211" stroke="black"/>
<line x1="420" y1="184" x2="420" y2="211" stroke="black"/>
<line x1="540" y1="184" x2="540" y2="211" stroke="black"/>
<polygon fill="white" points="368,184 472,184 472,209 368,209"/>
<line x1="368" y1="184" x2="472" y2="184" stroke="black"/>
<line x1="368" y1="209" x2="472" y2="209" stroke="black"/>
<line x1="368" y1="184" x2="368" y2="209" stroke="black"/>
<line x1="472" y1="184" x2="472" y2="209" stroke="black"/>
<polygon fill="white" points="370,191 468,191 468,201 370,201"/>
<text x="371" y="200" textLength="96" font-family="Helvetica" font-size="12" fill="black">
replay=D1; up=S1
</text>
<line x1="60" y1="211" x2="60" y2="238" stroke="black"/>
<line x1="180" y1="211" x2="180" y2="238" stroke="black"/>
<line x1="300" y1="211" x2="300" y2="238" stroke="black"/>
<line x1="420" y1="211" x2="420" y2="238" stroke="black"/>
<line x1="540" y1="211" x2="540" y2="238" stroke="black"/>
<line x1="420" y1="224" x2="60" y2="224" stroke="black"/>
<line x1="60" y1="224" x2="70" y2="230" stroke="black"/>
<polygon fill="white" points="232,213 246,213 246,223 232,223"/>
<text x="233" y="222" textLength="12" font-family="Helvetica" font-size="12" fill="black">
ok
</text>
<line x1="60" y1="238" x2="60" y2="265" stroke="black"/>
<line x1="180" y1="238" x2="180" y2="265" stroke="black"/>
<line x1="300" y1="238" x2="300" y2="265" stroke="black"/>
<line x1="420" y1="238" x2="420" y2="265" stroke="black"/>
<line x1="540" y1="238" x2="540" y2="265" stroke="black"/>
<polygon fill="white" points="202,245 396,245 396,255 202,255"/>
<text x="203" y="254" textLength="192" font-family="Helvetica" font-size="12" fill="black">
D2 is lost between Head and Middle
</text>
<line x1="30" y1="251" x2="202" y2="251" stroke="black" stroke-dasharray="2,2"/>
<line x1="398" y1="251" x2="570" y2="251" stroke="black" stroke-dasharray="2,2"/>
<line x1="60" y1="265" x2="60" y2="292" stroke="black"/>
<line x1="180" y1="265" x2="180" y2="292" stroke="black"/>
<line x1="300" y1="265" x2="300" y2="292" stroke="black"/>
<line x1="420" y1="265" x2="420" y2="292" stroke="black"/>
<line x1="540" y1="265" x2="540" y2="292" stroke="black"/>
<line x1="60" y1="278" x2="180" y2="278" stroke="black"/>
<line x1="180" y1="278" x2="170" y2="284" stroke="black"/>
<polygon fill="white" points="88,267 150,267 150,277 88,277"/>
<text x="89" y="276" textLength="60" font-family="Helvetica" font-size="12" fill="black">
add(K2,V2)
</text>
<line x1="60" y1="292" x2="60" y2="319" stroke="black"/>
<line x1="180" y1="292" x2="180" y2="319" stroke="black"/>
<line x1="300" y1="292" x2="300" y2="319" stroke="black"/>
<line x1="420" y1="292" x2="420" y2="319" stroke="black"/>
<line x1="540" y1="292" x2="540" y2="319" stroke="black"/>
<polygon fill="white" points="128,292 232,292 232,317 128,317"/>
<line x1="128" y1="292" x2="232" y2="292" stroke="black"/>
<line x1="128" y1="317" x2="232" y2="317" stroke="black"/>
<line x1="128" y1="292" x2="128" y2="317" stroke="black"/>
<line x1="232" y1="292" x2="232" y2="317" stroke="black"/>
<polygon fill="white" points="113,299 245,299 245,309 113,309"/>
<text x="114" y="308" textLength="130" font-family="Helvetica" font-size="12" fill="black">
replay=D1,D2; down=S2
</text>
<line x1="60" y1="319" x2="60" y2="346" stroke="black"/>
<line x1="180" y1="319" x2="180" y2="346" stroke="black"/>
<line x1="300" y1="319" x2="300" y2="346" stroke="black"/>
<line x1="420" y1="319" x2="420" y2="346" stroke="black"/>
<line x1="540" y1="319" x2="540" y2="346" stroke="black"/>
<line x1="180" y1="331" x2="300" y2="331" stroke="black"/>
<line x1="180" y1="333" x2="300" y2="333" stroke="black"/>
<polygon fill="black" points="300,332 290,338 290,326"/>
<polygon fill="white" points="114,321 364,321 364,331 114,331"/>
<text x="115" y="330" textLength="248" font-family="Helvetica" font-size="12" fill="black">
MESSAGE LOST: ch_replay_v2(K2,V2,S2,S1)
</text>
<line x1="60" y1="346" x2="60" y2="373" stroke="black" stroke-dasharray="2,2"/>
<line x1="180" y1="346" x2="180" y2="373" stroke="black" stroke-dasharray="2,2"/>
<line x1="300" y1="346" x2="300" y2="373" stroke="black" stroke-dasharray="2,2"/>
<line x1="420" y1="346" x2="420" y2="373" stroke="black" stroke-dasharray="2,2"/>
<line x1="540" y1="346" x2="540" y2="373" stroke="black" stroke-dasharray="2,2"/>
<line x1="60" y1="373" x2="60" y2="400" stroke="black"/>
<line x1="180" y1="373" x2="180" y2="400" stroke="black"/>
<line x1="300" y1="373" x2="300" y2="400" stroke="black"/>
<line x1="420" y1="373" x2="420" y2="400" stroke="black"/>
<line x1="540" y1="373" x2="540" y2="400" stroke="black"/>
<path d="M 59 392 A58,6 0 0,1 60,379" stroke="black" fill="none"/><line x1="60" y1="392" x2="50" y2="398" stroke="black"/>
<polygon fill="white" points="60,375 101,375 101,385 60,385"/>
<text x="61" y="384" textLength="39" font-family="Helvetica" font-size="12" fill="black">
timeout
</text>
<line x1="60" y1="400" x2="60" y2="427" stroke="black" stroke-dasharray="2,2"/>
<line x1="180" y1="400" x2="180" y2="427" stroke="black" stroke-dasharray="2,2"/>
<line x1="300" y1="400" x2="300" y2="427" stroke="black" stroke-dasharray="2,2"/>
<line x1="420" y1="400" x2="420" y2="427" stroke="black" stroke-dasharray="2,2"/>
<line x1="540" y1="400" x2="540" y2="427" stroke="black" stroke-dasharray="2,2"/>
<line x1="60" y1="427" x2="60" y2="454" stroke="black"/>
<line x1="180" y1="427" x2="180" y2="454" stroke="black"/>
<line x1="300" y1="427" x2="300" y2="454" stroke="black"/>
<line x1="420" y1="427" x2="420" y2="454" stroke="black"/>
<line x1="540" y1="427" x2="540" y2="454" stroke="black"/>
<polygon fill="white" points="196,434 402,434 402,444 196,444"/>
<text x="197" y="443" textLength="204" font-family="Helvetica" font-size="12" fill="black">
Behaviour has changed from this point
</text>
<line x1="30" y1="440" x2="196" y2="440" stroke="black" stroke-dasharray="2,2"/>
<line x1="404" y1="440" x2="570" y2="440" stroke="black" stroke-dasharray="2,2"/>
<line x1="60" y1="454" x2="60" y2="481" stroke="black" stroke-dasharray="2,2"/>
<line x1="180" y1="454" x2="180" y2="481" stroke="black" stroke-dasharray="2,2"/>
<line x1="300" y1="454" x2="300" y2="481" stroke="black" stroke-dasharray="2,2"/>
<line x1="420" y1="454" x2="420" y2="481" stroke="black" stroke-dasharray="2,2"/>
<line x1="540" y1="454" x2="540" y2="481" stroke="black" stroke-dasharray="2,2"/>
<line x1="60" y1="481" x2="60" y2="508" stroke="black"/>
<line x1="180" y1="481" x2="180" y2="508" stroke="black"/>
<line x1="300" y1="481" x2="300" y2="508" stroke="black"/>
<line x1="420" y1="481" x2="420" y2="508" stroke="black"/>
<line x1="540" y1="481" x2="540" y2="508" stroke="black"/>
<polygon fill="white" points="268,488 331,488 331,498 268,498"/>
<text x="269" y="497" textLength="61" font-family="Helvetica" font-size="12" fill="black">
D3 = K3,V3
</text>
<line x1="30" y1="494" x2="268" y2="494" stroke="black" stroke-dasharray="2,2"/>
<line x1="333" y1="494" x2="570" y2="494" stroke="black" stroke-dasharray="2,2"/>
<line x1="60" y1="508" x2="60" y2="535" stroke="black"/>
<line x1="180" y1="508" x2="180" y2="535" stroke="black"/>
<line x1="300" y1="508" x2="300" y2="535" stroke="black"/>
<line x1="420" y1="508" x2="420" y2="535" stroke="black"/>
<line x1="540" y1="508" x2="540" y2="535" stroke="black"/>
<line x1="60" y1="521" x2="180" y2="521" stroke="black"/>
<line x1="180" y1="521" x2="170" y2="527" stroke="black"/>
<polygon fill="white" points="88,510 150,510 150,520 88,520"/>
<text x="89" y="519" textLength="60" font-family="Helvetica" font-size="12" fill="black">
add(K3,V3)
</text>
<line x1="60" y1="535" x2="60" y2="562" stroke="black"/>
<line x1="180" y1="535" x2="180" y2="562" stroke="black"/>
<line x1="300" y1="535" x2="300" y2="562" stroke="black"/>
<line x1="420" y1="535" x2="420" y2="562" stroke="black"/>
<line x1="540" y1="535" x2="540" y2="562" stroke="black"/>
<polygon fill="white" points="128,535 232,535 232,560 128,560"/>
<line x1="128" y1="535" x2="232" y2="535" stroke="black"/>
<line x1="128" y1="560" x2="232" y2="560" stroke="black"/>
<line x1="128" y1="535" x2="128" y2="560" stroke="black"/>
<line x1="232" y1="535" x2="232" y2="560" stroke="black"/>
<polygon fill="white" points="104,542 255,542 255,552 104,552"/>
<text x="105" y="551" textLength="149" font-family="Helvetica" font-size="12" fill="black">
replay=D1,D2,D3; down=S3
</text>
<line x1="60" y1="562" x2="60" y2="589" stroke="black"/>
<line x1="180" y1="562" x2="180" y2="589" stroke="black"/>
<line x1="300" y1="562" x2="300" y2="589" stroke="black"/>
<line x1="420" y1="562" x2="420" y2="589" stroke="black"/>
<line x1="540" y1="562" x2="540" y2="589" stroke="black"/>
<path d="M 300 567 A60,6 0 0,1 299,580" stroke="black" fill="none"/><path d="M 300 569 A60,6 0 0,1 299,582" stroke="black" fill="none"/><polygon fill="black" points="300,581 310,587 310,575"/>
<polygon fill="white" points="259,564 298,564 298,574 259,574"/>
<text x="260" y="573" textLength="37" font-family="Helvetica" font-size="12" fill="black">
DOWN
</text>
<line x1="60" y1="589" x2="60" y2="616" stroke="black"/>
<line x1="180" y1="589" x2="180" y2="616" stroke="black"/>
<line x1="300" y1="589" x2="300" y2="616" stroke="black"/>
<line x1="420" y1="589" x2="420" y2="616" stroke="black"/>
<line x1="540" y1="589" x2="540" y2="616" stroke="black"/>
<polygon fill="white" points="248,589 352,589 352,614 248,614"/>
<line x1="248" y1="589" x2="352" y2="589" stroke="black"/>
<line x1="248" y1="614" x2="352" y2="614" stroke="black"/>
<line x1="248" y1="589" x2="248" y2="614" stroke="black"/>
<line x1="352" y1="589" x2="352" y2="614" stroke="black"/>
<polygon fill="white" points="201,596 398,596 398,606 201,606"/>
<text x="202" y="605" textLength="195" font-family="Helvetica" font-size="12" fill="black">
replay=D1; up=S1; got_down=TRUE
</text>
<line x1="60" y1="616" x2="60" y2="643" stroke="black"/>
<line x1="180" y1="616" x2="180" y2="643" stroke="black"/>
<line x1="300" y1="616" x2="300" y2="643" stroke="black"/>
<line x1="420" y1="616" x2="420" y2="643" stroke="black"/>
<line x1="540" y1="616" x2="540" y2="643" stroke="black"/>
<line x1="180" y1="629" x2="300" y2="629" stroke="black"/>
<line x1="300" y1="629" x2="290" y2="635" stroke="black"/>
<polygon fill="white" points="164,618 314,618 314,628 164,628"/>
<text x="165" y="627" textLength="148" font-family="Helvetica" font-size="12" fill="black">
ch_replay_v2(K3,V3,S3,S2)
</text>
<line x1="60" y1="643" x2="60" y2="670" stroke="black"/>
<line x1="180" y1="643" x2="180" y2="670" stroke="black"/>
<line x1="300" y1="643" x2="300" y2="670" stroke="black"/>
<line x1="420" y1="643" x2="420" y2="670" stroke="black"/>
<line x1="540" y1="643" x2="540" y2="670" stroke="black"/>
<polygon fill="white" points="248,643 352,643 352,668 248,668"/>
<line x1="254" y1="643" x2="346" y2="643" stroke="black"/>
<line x1="254" y1="668" x2="346" y2="668" stroke="black"/>
<line x1="254" y1="643" x2="248" y2="655" stroke="black"/>
<line x1="248" y1="655" x2="254" y2="668" stroke="black"/>
<line x1="346" y1="643" x2="352" y2="655" stroke="black"/>
<line x1="352" y1="655" x2="346" y2="668" stroke="black"/>
<polygon fill="white" points="185,650 414,650 414,660 185,660"/>
<text x="186" y="659" textLength="227" font-family="Helvetica" font-size="12" fill="black">
last&lt;S2&gt; != up&lt;S1&gt; &amp;&amp; got_down==TRUE
</text>
<line x1="60" y1="670" x2="60" y2="697" stroke="black"/>
<line x1="180" y1="670" x2="180" y2="697" stroke="black"/>
<line x1="300" y1="670" x2="300" y2="697" stroke="black"/>
<line x1="420" y1="670" x2="420" y2="697" stroke="black"/>
<line x1="540" y1="670" x2="540" y2="697" stroke="black"/>
<path d="M 300 675 A60,6 0 0,1 299,688" stroke="black" fill="none"/><path d="M 300 677 A60,6 0 0,1 299,690" stroke="black" fill="none"/><polygon fill="black" points="300,689 310,695 310,683"/>
<polygon fill="white" points="181,672 298,672 298,682 181,682"/>
<text x="182" y="681" textLength="115" font-family="Helvetica" font-size="12" fill="black">
MIDDLE BRICK EXIT
</text>
<line x1="60" y1="697" x2="60" y2="724" stroke="black"/>
<line x1="180" y1="697" x2="180" y2="724" stroke="black"/>
<line x1="300" y1="697" x2="300" y2="724" stroke="black"/>
<line x1="420" y1="697" x2="420" y2="724" stroke="black"/>
<line x1="540" y1="697" x2="540" y2="724" stroke="black"/>
<polygon fill="white" points="171,704 428,704 428,714 171,714"/>
<text x="172" y="713" textLength="255" font-family="Helvetica" font-size="12" fill="black">
Admin changes connections to remove MIDDLE
</text>
<line x1="30" y1="710" x2="171" y2="710" stroke="black" stroke-dasharray="2,2"/>
<line x1="430" y1="710" x2="570" y2="710" stroke="black" stroke-dasharray="2,2"/>
<line x1="60" y1="724" x2="60" y2="751" stroke="black"/>
<line x1="180" y1="724" x2="180" y2="751" stroke="black"/>
<line x1="300" y1="724" x2="300" y2="751" stroke="black"/>
<line x1="420" y1="724" x2="420" y2="751" stroke="black"/>
<line x1="540" y1="724" x2="540" y2="751" stroke="black"/>
<path d="M 420 729 A60,6 0 0,1 419,742" stroke="black" fill="none"/><path d="M 420 731 A60,6 0 0,1 419,744" stroke="black" fill="none"/><polygon fill="black" points="420,743 430,749 430,737"/>
<polygon fill="white" points="379,726 418,726 418,736 379,736"/>
<text x="380" y="735" textLength="37" font-family="Helvetica" font-size="12" fill="black">
DOWN
</text>
<line x1="60" y1="751" x2="60" y2="778" stroke="black"/>
<line x1="180" y1="751" x2="180" y2="778" stroke="black"/>
<line x1="300" y1="751" x2="300" y2="778" stroke="black"/>
<line x1="420" y1="751" x2="420" y2="778" stroke="black"/>
<line x1="540" y1="751" x2="540" y2="778" stroke="black"/>
<polygon fill="white" points="368,751 472,751 472,776 368,776"/>
<line x1="368" y1="751" x2="472" y2="751" stroke="black"/>
<line x1="368" y1="776" x2="472" y2="776" stroke="black"/>
<line x1="368" y1="751" x2="368" y2="776" stroke="black"/>
<line x1="472" y1="751" x2="472" y2="776" stroke="black"/>
<polygon fill="white" points="319,758 519,758 519,768 319,768"/>
<text x="320" y="767" textLength="198" font-family="Helvetica" font-size="12" fill="black">
replay=D1 ; up=S1; got_down=TRUE
</text>
<line x1="60" y1="778" x2="60" y2="805" stroke="black"/>
<line x1="180" y1="778" x2="180" y2="805" stroke="black"/>
<line x1="300" y1="778" x2="300" y2="805" stroke="black"/>
<line x1="420" y1="778" x2="420" y2="805" stroke="black"/>
<line x1="540" y1="778" x2="540" y2="805" stroke="black"/>
<line x1="540" y1="791" x2="420" y2="791" stroke="black"/>
<line x1="420" y1="791" x2="430" y2="797" stroke="black"/>
<polygon fill="white" points="370,780 588,780 588,790 370,790"/>
<text x="371" y="789" textLength="216" font-family="Helvetica" font-size="12" fill="black">
role_tail(upstream=HEAD,downstream=)
</text>
<line x1="60" y1="805" x2="60" y2="832" stroke="black"/>
<line x1="180" y1="805" x2="180" y2="832" stroke="black"/>
<line x1="300" y1="805" x2="300" y2="832" stroke="black"/>
<line x1="420" y1="805" x2="420" y2="832" stroke="black"/>
<line x1="540" y1="805" x2="540" y2="832" stroke="black"/>
<polygon fill="white" points="368,805 472,805 472,830 368,830"/>
<line x1="368" y1="805" x2="472" y2="805" stroke="black"/>
<line x1="368" y1="830" x2="472" y2="830" stroke="black"/>
<line x1="368" y1="805" x2="368" y2="830" stroke="black"/>
<line x1="472" y1="805" x2="472" y2="830" stroke="black"/>
<polygon fill="white" points="317,812 522,812 522,822 317,822"/>
<text x="318" y="821" textLength="203" font-family="Helvetica" font-size="12" fill="black">
replay=D1 ; up=S1; got_down=FALSE
</text>
<line x1="60" y1="832" x2="60" y2="859" stroke="black"/>
<line x1="180" y1="832" x2="180" y2="859" stroke="black"/>
<line x1="300" y1="832" x2="300" y2="859" stroke="black"/>
<line x1="420" y1="832" x2="420" y2="859" stroke="black"/>
<line x1="540" y1="832" x2="540" y2="859" stroke="black"/>
<line x1="540" y1="845" x2="180" y2="845" stroke="black"/>
<line x1="180" y1="845" x2="190" y2="851" stroke="black"/>
<polygon fill="white" points="249,834 470,834 470,844 249,844"/>
<text x="250" y="843" textLength="219" font-family="Helvetica" font-size="12" fill="black">
role_head(upstream=,downstream=TAIL)
</text>
<line x1="60" y1="859" x2="60" y2="886" stroke="black"/>
<line x1="180" y1="859" x2="180" y2="886" stroke="black"/>
<line x1="300" y1="859" x2="300" y2="886" stroke="black"/>
<line x1="420" y1="859" x2="420" y2="886" stroke="black"/>
<line x1="540" y1="859" x2="540" y2="886" stroke="black"/>
<polygon fill="white" points="181,866 417,866 417,876 181,876"/>
<text x="182" y="875" textLength="234" font-family="Helvetica" font-size="12" fill="black">
HEAD replays to new DOWNSTREAM TAIL
</text>
<line x1="30" y1="872" x2="181" y2="872" stroke="black" stroke-dasharray="2,2"/>
<line x1="419" y1="872" x2="570" y2="872" stroke="black" stroke-dasharray="2,2"/>
<line x1="60" y1="886" x2="60" y2="913" stroke="black"/>
<line x1="180" y1="886" x2="180" y2="913" stroke="black"/>
<line x1="300" y1="886" x2="300" y2="913" stroke="black"/>
<line x1="420" y1="886" x2="420" y2="913" stroke="black"/>
<line x1="540" y1="886" x2="540" y2="913" stroke="black"/>
<line x1="180" y1="899" x2="420" y2="899" stroke="black"/>
<line x1="420" y1="899" x2="410" y2="905" stroke="black"/>
<polygon fill="white" points="224,888 374,888 374,898 224,898"/>
<text x="225" y="897" textLength="148" font-family="Helvetica" font-size="12" fill="black">
ch_replay_v2(K1,V1,S1,S0)
</text>
<line x1="60" y1="913" x2="60" y2="940" stroke="black"/>
<line x1="180" y1="913" x2="180" y2="940" stroke="black"/>
<line x1="300" y1="913" x2="300" y2="940" stroke="black"/>
<line x1="420" y1="913" x2="420" y2="940" stroke="black"/>
<line x1="540" y1="913" x2="540" y2="940" stroke="black"/>
<polygon fill="white" points="368,913 472,913 472,938 368,938"/>
<line x1="368" y1="913" x2="472" y2="913" stroke="black"/>
<line x1="368" y1="938" x2="472" y2="938" stroke="black"/>
<line x1="368" y1="913" x2="368" y2="938" stroke="black"/>
<line x1="472" y1="913" x2="472" y2="938" stroke="black"/>
<polygon fill="white" points="370,920 468,920 468,930 370,930"/>
<text x="371" y="929" textLength="96" font-family="Helvetica" font-size="12" fill="black">
replay=D1; up=S1
</text>
<line x1="60" y1="940" x2="60" y2="967" stroke="black"/>
<line x1="180" y1="940" x2="180" y2="967" stroke="black"/>
<line x1="300" y1="940" x2="300" y2="967" stroke="black"/>
<line x1="420" y1="940" x2="420" y2="967" stroke="black"/>
<line x1="540" y1="940" x2="540" y2="967" stroke="black"/>
<line x1="180" y1="953" x2="420" y2="953" stroke="black"/>
<line x1="420" y1="953" x2="410" y2="959" stroke="black"/>
<polygon fill="white" points="224,942 374,942 374,952 224,952"/>
<text x="225" y="951" textLength="148" font-family="Helvetica" font-size="12" fill="black">
ch_replay_v2(K2,V2,S2,S1)
</text>
<line x1="60" y1="967" x2="60" y2="994" stroke="black"/>
<line x1="180" y1="967" x2="180" y2="994" stroke="black"/>
<line x1="300" y1="967" x2="300" y2="994" stroke="black"/>
<line x1="420" y1="967" x2="420" y2="994" stroke="black"/>
<line x1="540" y1="967" x2="540" y2="994" stroke="black"/>
<polygon fill="white" points="368,967 472,967 472,992 368,992"/>
<line x1="368" y1="967" x2="472" y2="967" stroke="black"/>
<line x1="368" y1="992" x2="472" y2="992" stroke="black"/>
<line x1="368" y1="967" x2="368" y2="992" stroke="black"/>
<line x1="472" y1="967" x2="472" y2="992" stroke="black"/>
<polygon fill="white" points="361,974 478,974 478,984 361,984"/>
<text x="362" y="983" textLength="115" font-family="Helvetica" font-size="12" fill="black">
replay=D1,D2; up=S2
</text>
<line x1="60" y1="994" x2="60" y2="1021" stroke="black"/>
<line x1="180" y1="994" x2="180" y2="1021" stroke="black"/>
<line x1="300" y1="994" x2="300" y2="1021" stroke="black"/>
<line x1="420" y1="994" x2="420" y2="1021" stroke="black"/>
<line x1="540" y1="994" x2="540" y2="1021" stroke="black"/>
<line x1="180" y1="1007" x2="420" y2="1007" stroke="black"/>
<line x1="420" y1="1007" x2="410" y2="1013" stroke="black"/>
<polygon fill="white" points="224,996 374,996 374,1006 224,1006"/>
<text x="225" y="1005" textLength="148" font-family="Helvetica" font-size="12" fill="black">
ch_replay_v2(K3,V3,S3,S2)
</text>
<line x1="60" y1="1021" x2="60" y2="1048" stroke="black"/>
<line x1="180" y1="1021" x2="180" y2="1048" stroke="black"/>
<line x1="300" y1="1021" x2="300" y2="1048" stroke="black"/>
<line x1="420" y1="1021" x2="420" y2="1048" stroke="black"/>
<line x1="540" y1="1021" x2="540" y2="1048" stroke="black"/>
<polygon fill="white" points="368,1021 472,1021 472,1046 368,1046"/>
<line x1="368" y1="1021" x2="472" y2="1021" stroke="black"/>
<line x1="368" y1="1046" x2="472" y2="1046" stroke="black"/>
<line x1="368" y1="1021" x2="368" y2="1046" stroke="black"/>
<line x1="472" y1="1021" x2="472" y2="1046" stroke="black"/>
<polygon fill="white" points="351,1028 487,1028 487,1038 351,1038"/>
<text x="352" y="1037" textLength="134" font-family="Helvetica" font-size="12" fill="black">
replay=D1,D2,D3; up=S3
</text>
<line x1="60" y1="1048" x2="60" y2="1075" stroke="black"/>
<line x1="180" y1="1048" x2="180" y2="1075" stroke="black"/>
<line x1="300" y1="1048" x2="300" y2="1075" stroke="black"/>
<line x1="420" y1="1048" x2="420" y2="1075" stroke="black"/>
<line x1="540" y1="1048" x2="540" y2="1075" stroke="black"/>
<polygon fill="white" points="266,1055 332,1055 332,1065 266,1065"/>
<text x="267" y="1064" textLength="64" font-family="Helvetica" font-size="12" fill="black">
tail acks S3.
</text>
<line x1="30" y1="1061" x2="266" y2="1061" stroke="black" stroke-dasharray="2,2"/>
<line x1="334" y1="1061" x2="570" y2="1061" stroke="black" stroke-dasharray="2,2"/>
<line x1="60" y1="1075" x2="60" y2="1102" stroke="black"/>
<line x1="180" y1="1075" x2="180" y2="1102" stroke="black"/>
<line x1="300" y1="1075" x2="300" y2="1102" stroke="black"/>
<line x1="420" y1="1075" x2="420" y2="1102" stroke="black"/>
<line x1="540" y1="1075" x2="540" y2="1102" stroke="black"/>
<path d="M 420 1081 A60,6 0 0,1 419,1094" stroke="black" fill="none"/><line x1="420" y1="1094" x2="430" y2="1100" stroke="black"/>
<polygon fill="white" points="382,1077 418,1077 418,1087 382,1087"/>
<text x="383" y="1086" textLength="34" font-family="Helvetica" font-size="12" fill="black">
timer()
</text>
<line x1="60" y1="1102" x2="60" y2="1129" stroke="black"/>
<line x1="180" y1="1102" x2="180" y2="1129" stroke="black"/>
<line x1="300" y1="1102" x2="300" y2="1129" stroke="black"/>
<line x1="420" y1="1102" x2="420" y2="1129" stroke="black"/>
<line x1="540" y1="1102" x2="540" y2="1129" stroke="black"/>
<polygon fill="white" points="368,1102 472,1102 472,1127 368,1127"/>
<line x1="368" y1="1102" x2="472" y2="1102" stroke="black"/>
<line x1="368" y1="1127" x2="472" y2="1127" stroke="black"/>
<line x1="368" y1="1102" x2="368" y2="1127" stroke="black"/>
<line x1="472" y1="1102" x2="472" y2="1127" stroke="black"/>
<polygon fill="white" points="376,1109 462,1109 462,1119 376,1119"/>
<text x="377" y="1118" textLength="84" font-family="Helvetica" font-size="12" fill="black">
replay= ; up=S3
</text>
<line x1="60" y1="1129" x2="60" y2="1156" stroke="black"/>
<line x1="180" y1="1129" x2="180" y2="1156" stroke="black"/>
<line x1="300" y1="1129" x2="300" y2="1156" stroke="black"/>
<line x1="420" y1="1129" x2="420" y2="1156" stroke="black"/>
<line x1="540" y1="1129" x2="540" y2="1156" stroke="black"/>
<line x1="420" y1="1142" x2="180" y2="1142" stroke="black"/>
<line x1="180" y1="1142" x2="190" y2="1148" stroke="black"/>
<polygon fill="white" points="278,1131 321,1131 321,1141 278,1141"/>
<text x="279" y="1140" textLength="41" font-family="Helvetica" font-size="12" fill="black">
ack(S3)
</text>
<line x1="60" y1="1156" x2="60" y2="1183" stroke="black"/>
<line x1="180" y1="1156" x2="180" y2="1183" stroke="black"/>
<line x1="300" y1="1156" x2="300" y2="1183" stroke="black"/>
<line x1="420" y1="1156" x2="420" y2="1183" stroke="black"/>
<line x1="540" y1="1156" x2="540" y2="1183" stroke="black"/>
<polygon fill="white" points="128,1156 232,1156 232,1181 128,1181"/>
<line x1="128" y1="1156" x2="232" y2="1156" stroke="black"/>
<line x1="128" y1="1181" x2="232" y2="1181" stroke="black"/>
<line x1="128" y1="1156" x2="128" y2="1181" stroke="black"/>
<line x1="232" y1="1156" x2="232" y2="1181" stroke="black"/>
<polygon fill="white" points="128,1163 230,1163 230,1173 128,1173"/>
<text x="129" y="1172" textLength="100" font-family="Helvetica" font-size="12" fill="black">
replay= ; down=S3
</text>
<line x1="60" y1="1183" x2="60" y2="1210" stroke="black"/>
<line x1="180" y1="1183" x2="180" y2="1210" stroke="black"/>
<line x1="300" y1="1183" x2="300" y2="1210" stroke="black"/>
<line x1="420" y1="1183" x2="420" y2="1210" stroke="black"/>
<line x1="540" y1="1183" x2="540" y2="1210" stroke="black"/>
<polygon fill="white" points="193,1190 406,1190 406,1200 193,1200"/>
<text x="194" y="1199" textLength="211" font-family="Helvetica" font-size="12" fill="black">
Head has D1,D2,D3, tail has D1,D2,D3.
</text>
<line x1="30" y1="1196" x2="193" y2="1196" stroke="black" stroke-dasharray="2,2"/>
<line x1="408" y1="1196" x2="570" y2="1196" stroke="black" stroke-dasharray="2,2"/>
<line x1="60" y1="1210" x2="60" y2="1237" stroke="black"/>
<line x1="180" y1="1210" x2="180" y2="1237" stroke="black"/>
<line x1="300" y1="1210" x2="300" y2="1237" stroke="black"/>
<line x1="420" y1="1210" x2="420" y2="1237" stroke="black"/>
<line x1="540" y1="1210" x2="540" y2="1237" stroke="black"/>
<polygon fill="white" points="161,1217 437,1217 437,1227 161,1227"/>
<text x="162" y="1226" textLength="274" font-family="Helvetica" font-size="12" fill="black">
OLD MIDDLE brick will start repair normall from tail.
</text>
<line x1="30" y1="1223" x2="161" y2="1223" stroke="black" stroke-dasharray="2,2"/>
<line x1="439" y1="1223" x2="570" y2="1223" stroke="black" stroke-dasharray="2,2"/>
</svg>
